*** Settings ***
Resource          ../../关键字封装/资源文件/通用封装(all_included).txt
Library           Selenium2Library

*** Keywords ***
列表点击新增
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    Map_AppGridMenu_点击列表菜单项    新增
    unselect frame

列表点击删除
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe    ${DelMessage}=确实要删除选择的记录吗？
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '删除')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    删除    ELSE    Map_AppGridMenu_点击列表菜单项    更多操作/删除
    Win Activate    来自网页的消息    ${DelMessage}
    Control Click    来自网页的消息    确定    Button1
    unselect frame

列表点击作废
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe    ${DelMessage}=确实要作废所选记录吗？
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    Map_AppGridMenu_点击列表菜单项    更多操作/作废
    Choose Ok On Next Confirmation
    confirm action
    unselect frame

列表点击发起审批
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '审批')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    审批/发起审批    ELSE    Map_AppGridMenu_点击列表菜单项    发起审批
    unselect frame

列表点击审批过程
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '审批')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    审批/审批过程    ELSE    Map_AppGridMenu_点击列表菜单项    审批过程
    unselect frame

列表点击提交审批
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '审批')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    审批/提交审批    ELSE    Map_AppGridMenu_点击列表菜单项    提交审批
    unselect frame

列表点击审批通过
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '审批')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    审批/审批通过    ELSE    Map_AppGridMenu_点击列表菜单项    审批通过
    unselect frame

列表点击审批驳回
    [Arguments]    ${AppGridMenuFrameName}=stage/appIframe
    [Documentation]    一级界面有多种情况，每种情况下所要进的Frame不一致，所以将Frame作为参数传递，如：
    ...    1、常用界面：如成本管理的设计变更模块，Frame为stage1/appIframe
    ...    2、带上标签的一级界面：如成本管理的合同变更模块，Frame为stage1/ifrmHtAlter/appIframe
    ...    3、上下列表：如成本管理的合同结算模块，下列表Frame为stage1/belowIframe
    select frame    ${AppGridMenuFrameName}
    ${local_IsVisible}=    Run Keyword And Return Status    Element Should Be Visible    xpath=//table[@class='mnubar']//span[contains(text(), '审批')]
    Run Keyword If    '${local_IsVisible}'=='True'    Map_AppGridMenu_点击列表菜单项    审批/审批驳回    ELSE    Map_AppGridMenu_点击列表菜单项    审批驳回
    unselect frame

列表点击按钮
    [Arguments]    ${AppGridMenuFrameName}    ${menuPath}
    [Documentation]    *功能：*
    ...
    ...    点击列表上方菜单项
    ...
    ...    *参数说明：*
    ...
    ...    FrameName：列表操作按钮要进入的Frame
    ...    menuPath: 菜单路径，父菜单与子菜单之间用"/"分割
    ...
    ...    *示例：*
    ...
    ...    1. 独立菜单场景 ：列表点击按钮 | stage1/appIframe | \ 新增/预计合同
    select frame    ${AppGridMenuFrameName}
    Map_AppGridMenu_点击列表菜单项    ${menuPath}
    unselect frame
